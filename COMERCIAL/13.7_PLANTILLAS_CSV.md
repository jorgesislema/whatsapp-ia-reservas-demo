# 13.7 Plantillas CSV para Carga de Datos

Todos los archivos CSV que necesitas para cargar datos en el panel.

---

## üìã **1. MENU.CSV ‚Äî Productos del Restaurante**

### Estructura

```csv
nombre,categoria,precio,alergenos,visible,descripcion
Milanesa Napolitana,Principales,850.00,"gluten,huevo",true,Milanesa con queso y tomate
Ensalada Fresca,Ensaladas,350.00,"",true,Lechuga arrepollada con tomate
Pizza Margherita,Pizzas,450.00,"gluten,lacteos",true,Masa cl√°sica con queso mozzarella
Agua Mineral,Bebidas,80.00,"",true,Botella 500ml
Helado Chocolate,Postres,120.00,"lacteos,nueces",true,Helado 1 cuchar√≥n
```

### Campos explicados

| Campo | Descripci√≥n | Ejemplo | Obligatorio? |
|-------|-------------|---------|--------------|
| `nombre` | Nombre del producto | "Milanesa Napolitana" | ‚úÖ S√ç |
| `categoria` | Tipo (carpeta) | "Principales" | ‚úÖ S√ç |
| `precio` | Precio en $ARS | 850.00 | ‚úÖ S√ç |
| `alergenos` | Separados por coma | "gluten,huevo" | ‚ùå NO |
| `visible` | Mostrar en bot? (true/false) | true | ‚úÖ S√ç |
| `descripcion` | Descripci√≥n breve | "Milanesa con queso..." | ‚ùå NO |

### Validaci√≥n

- ‚úÖ **Nombre:** M√°x 100 caracteres, puede tener √±, acentos
- ‚úÖ **Precio:** Solo n√∫meros y . (punto decimal)
- ‚úÖ **Alergenos:** Valores permitidos:
  - gluten, lacteos, huevo, man√≠, nueces, soja, mostaza, s√©samo, marisco, pescado
- ‚úÖ **Visible:** SOLO `true` o `false` (min√∫sculas)

### Descarga plantilla

```bash
# Plantilla vac√≠a para llenar
curl -o menu_template.csv https://[tu-panel]/templates/menu.csv
```

### Cargar en panel

1. Panel ‚Üí Men√∫ ‚Üí "Importar CSV"
2. Selecciona tu archivo menu.csv
3. Click "Cargar"
4. ‚è≥ Espera (1-2 minutos)
5. ‚úÖ Confirmaci√≥n

---

## üïê **2. HOURS.CSV ‚Äî Horarios Semanales**

### Estructura

```csv
dia,abre,cierra
Lunes,12:00,23:00
Martes,12:00,23:00
Mi√©rcoles,12:00,23:00
Jueves,12:00,00:00
Viernes,12:00,00:00
S√°bado,11:00,01:00
Domingo,11:00,23:00
```

### Campos explicados

| Campo | Descripci√≥n | Ejemplo | Obligatorio? |
|-------|-------------|---------|--------------|
| `dia` | Nombre del d√≠a | "Lunes" (exacto) | ‚úÖ S√ç |
| `abre` | Hora apertura HH:MM | 12:00 | ‚úÖ S√ç |
| `cierra` | Hora cierre HH:MM | 23:00 | ‚úÖ S√ç |

### Validaci√≥n

- ‚úÖ **Dia:** EXACTAMENTE: Lunes, Martes, Mi√©rcoles, Jueves, Viernes, S√°bado, Domingo
- ‚úÖ **Hora:** Formato 24h HH:MM (ej: 09:00, 23:30, 00:00)
- ‚úÖ **Cierre despu√©s que apertura:** Si abre 23:00 y cierra 05:00 (madrugada), sistema lo entiende

### Notas especiales

- **Cerrado un d√≠a:** Deja blanco o repite 00:00 - 00:00
- **Abierto 24/7:** `00:00` - `23:59` (no es 24h exacto pero aproxima)

---

## ‚ö†Ô∏è **3. EXCEPTIONS.CSV ‚Äî Feriados, Cierres Especiales**

### Estructura

```csv
fecha,estado,abre,cierra,nota
2025-01-01,true,,,A√±o Nuevo - Cerrado
2025-01-15,false,12:00,18:00,Cierre anticipado
2025-12-24,false,12:00,19:00,Noche Buena
2025-12-25,true,,,Navidad - Cerrado
```

### Campos explicados

| Campo | Descripci√≥n | Ejemplo | Obligatorio? |
|-------|-------------|---------|--------------|
| `fecha` | Fecha YYYY-MM-DD | 2025-01-01 | ‚úÖ S√ç |
| `estado` | true=cerrado, false=horario especial | true | ‚úÖ S√ç |
| `abre` | Hora si `estado=false` | 12:00 | ‚ùå NO |
| `cierra` | Hora si `estado=false` | 18:00 | ‚ùå NO |
| `nota` | Descripci√≥n (cliente la ve) | "A√±o Nuevo" | ‚ùå NO |

### Validaci√≥n

- ‚úÖ **Fecha:** YYYY-MM-DD (ej: 2025-12-25)
- ‚úÖ **Estado:** SOLO `true` (cerrado) o `false` (abierto reducido)
- ‚úÖ **Si estado=true:** Deja abre/cierra vac√≠o
- ‚úÖ **Si estado=false:** Completa abre y cierra

### Ejemplos

```csv
# D√≠a feriado (cerrado todo el d√≠a)
2025-12-25,true,,,Navidad

# D√≠a con horario reducido (Noche Buena: apertura anticipada)
2025-12-24,false,12:00,19:00,Noche Buena - Cierre 19hs

# Cierre para reforma (toda la semana)
2025-02-03,true,,,Reforma
2025-02-04,true,,,Reforma
2025-02-05,true,,,Reforma
2025-02-06,true,,,Reforma
2025-02-07,true,,,Reforma
```

---

## üå°Ô∏è **4. SEASONS.CSV ‚Äî Horarios por Temporada (Opcional)**

√ösalo si tienes horarios muy diferentes por estaci√≥n (ej: verano vs invierno).

### Estructura

```csv
nombre,inicio,fin,abre,cierra
Verano,2024-12-21,2025-03-20,11:00,00:00
Invierno,2025-03-21,2025-06-20,12:00,23:00
Primavera,2025-06-21,2025-09-22,11:30,23:30
Oto√±o,2025-09-23,2024-12-20,12:00,23:00
```

### Campos explicados

| Campo | Descripci√≥n | Ejemplo | Obligatorio? |
|-------|-------------|---------|--------------|
| `nombre` | Nombre temporada | "Verano" | ‚úÖ S√ç |
| `inicio` | Fecha inicio YYYY-MM-DD | 2024-12-21 | ‚úÖ S√ç |
| `fin` | Fecha fin YYYY-MM-DD | 2025-03-20 | ‚úÖ S√ç |
| `abre` | Hora apertura | 11:00 | ‚úÖ S√ç |
| `cierra` | Hora cierre | 00:00 | ‚úÖ S√ç |

### Validaci√≥n

- ‚úÖ **Fechas:** YYYY-MM-DD, rango debe ser l√≥gico (inicio < fin)
- ‚úÖ **No solapamiento:** Las temporadas NO deben solaparse
- ‚úÖ **Orden:** Orden cronol√≥gico recomendado

### C√≥mo funciona

```
SI cliente intenta reservar:
  - 15/1/2025 (fecha en "Verano") ‚Üí usa horario verano (11:00-00:00)
  - 10/4/2025 (fecha en "Primavera") ‚Üí usa horario primavera (11:30-23:30)
```

---

## üìù **COMBO: PLANTILLA COMPLETA**

Para empezar r√°pido, aqu√≠ est√° un combo de 4 archivos para un restaurante t√≠pico:

### menu.csv

```csv
nombre,categoria,precio,alergenos,visible,descripcion
Empanadas (3 unid),Entrada,280.00,"gluten",true,Fritas o al horno
Tabla de Quesos,Entrada,450.00,"lacteos",true,Selecci√≥n local
Milanesa Napolitana,Principales,850.00,"gluten,huevo,lacteos",true,Con queso y tomate
Carne Roja 300g,Principales,1200.00,"",true,A elecci√≥n del cliente
Salm√≥n Grillado,Principales,950.00,"pescado",true,Con lim√≥n y aceitunas
Pasta a la Carbonara,Principales,680.00,"gluten,huevo,lacteos",true,Receta italiana
Ensalada C√©sar,Ensaladas,420.00,"gluten,lacteos",true,Lechuga con pollo y crutones
Agua Mineral,Bebidas,80.00,"",true,Botella 500ml
Vino Casa,Bebidas,150.00,"",true,Copa de vino de la casa
Flan Casero,Postres,180.00,"lacteos,huevo",true,Con dulce de leche
```

### hours.csv

```csv
dia,abre,cierra
Lunes,12:00,23:00
Martes,12:00,23:00
Mi√©rcoles,12:00,23:00
Jueves,12:00,00:00
Viernes,12:00,00:00
S√°bado,11:00,01:00
Domingo,11:00,23:00
```

### exceptions.csv

```csv
fecha,estado,abre,cierra,nota
2025-01-01,true,,,A√±o Nuevo - Cerrado
2025-02-17,true,,,Feriado - Cerrado
2025-02-24,false,18:00,02:00,Lunes de Carnaval - Horario especial
2025-12-24,false,12:00,20:00,Noche Buena
2025-12-25,true,,,Navidad - Cerrado
```

---

## üöÄ **CARGAR TODO (BULK)**

### Script Python para cargar m√∫ltiples CSV

```python
# bulk_load.py - Cargar todos los CSV de una vez

import requests
import json

def bulk_upload_csv(panel_url, client_token, csv_files):
    """
    CSV files: {
        'menu': '/path/to/menu.csv',
        'hours': '/path/to/hours.csv',
        'exceptions': '/path/to/exceptions.csv',
        'seasons': '/path/to/seasons.csv' (optional)
    }
    """
    
    results = {}
    
    # 1. Cargar men√∫
    try:
        with open(csv_files['menu'], 'rb') as f:
            files = {'file': f}
            resp = requests.post(
                f"{panel_url}/api/import/menu",
                files=files,
                headers={"Authorization": f"Bearer {client_token}"}
            )
        results['menu'] = 'OK' if resp.status_code == 200 else f"ERROR: {resp.text}"
        print(f"‚úÖ Men√∫: {results['menu']}")
    except Exception as e:
        results['menu'] = f"ERROR: {e}"
        print(f"‚ùå Men√∫: {e}")
    
    # 2. Cargar horarios
    try:
        with open(csv_files['hours'], 'rb') as f:
            files = {'file': f}
            resp = requests.post(
                f"{panel_url}/api/import/hours",
                files=files,
                headers={"Authorization": f"Bearer {client_token}"}
            )
        results['hours'] = 'OK' if resp.status_code == 200 else f"ERROR: {resp.text}"
        print(f"‚úÖ Horarios: {results['hours']}")
    except Exception as e:
        results['hours'] = f"ERROR: {e}"
        print(f"‚ùå Horarios: {e}")
    
    # 3. Cargar excepciones
    try:
        with open(csv_files['exceptions'], 'rb') as f:
            files = {'file': f}
            resp = requests.post(
                f"{panel_url}/api/import/exceptions",
                files=files,
                headers={"Authorization": f"Bearer {client_token}"}
            )
        results['exceptions'] = 'OK' if resp.status_code == 200 else f"ERROR: {resp.text}"
        print(f"‚úÖ Excepciones: {results['exceptions']}")
    except Exception as e:
        results['exceptions'] = f"ERROR: {e}"
        print(f"‚ùå Excepciones: {e}")
    
    # 4. Cargar temporadas (si existe)
    if 'seasons' in csv_files and csv_files['seasons']:
        try:
            with open(csv_files['seasons'], 'rb') as f:
                files = {'file': f}
                resp = requests.post(
                    f"{panel_url}/api/import/seasons",
                    files=files,
                    headers={"Authorization": f"Bearer {client_token}"}
                )
            results['seasons'] = 'OK' if resp.status_code == 200 else f"ERROR: {resp.text}"
            print(f"‚úÖ Temporadas: {results['seasons']}")
        except Exception as e:
            results['seasons'] = f"ERROR: {e}"
            print(f"‚ùå Temporadas: {e}")
    
    return results

# USO:
panel_url = "https://wa-panel-cliente.streamlit.app"
client_token = "token-secreto-del-cliente"

results = bulk_upload_csv(panel_url, client_token, {
    'menu': 'data/menu.csv',
    'hours': 'data/hours.csv',
    'exceptions': 'data/exceptions.csv',
    'seasons': 'data/seasons.csv'
})

print("\n=== RESUMEN ===")
for key, val in results.items():
    print(f"{key}: {val}")
```

---

## ‚úÖ **CHECKLIST ANTES DE CARGAR**

- [ ] Archivo CSV guardado con **encoding UTF-8** (Excel: "CSV UTF-8")
- [ ] NO tiene espacios en blanco al inicio de filas
- [ ] Todas las fechas en formato **YYYY-MM-DD**
- [ ] Todos los horarios en formato **HH:MM** (24h)
- [ ] Precios usan . (punto) para decimales, NO , (coma)
- [ ] Headers exactos (nombre, categoria, precio, etc)
- [ ] NO hay tildes en nombres de columnas
- [ ] Archivo descargado de panel (si usando plantilla)

---

## üÜò **ERRORES COMUNES**

### "Invalid date format"
- **Problema:** Fecha como `01/01/2025` o `1-1-2025`
- **Soluci√≥n:** Usar `2025-01-01` (YYYY-MM-DD)

### "Price must be number"
- **Problema:** Precio escrito como `$850` o `850,50`
- **Soluci√≥n:** Solo n√∫meros: `850` o `850.50`

### "Unrecognized day name"
- **Problema:** Nombre de d√≠a como "Lun" o "Monday" o "lunes"
- **Soluci√≥n:** Exactamente: `Lunes`, `Martes`, `Mi√©rcoles`, etc (may√∫scula)

### "Duplicate product"
- **Problema:** Mismo nombre en dos filas del menu.csv
- **Soluci√≥n:** Cambiar uno (ej: "Milanesa" vs "Milanesa Grande")

### "Empty field"
- **Problema:** Campo obligatorio vac√≠o (ej: sin precio)
- **Soluci√≥n:** Completar todos los campos obligatorios

---

## üìä **COMPARATIVA: MANUAL vs BULK**

| Acci√≥n | Manual (Panel) | CSV Bulk | Cu√°ndo usar |
|--------|---|---|---|
| Agregar 1 producto | ‚úÖ 1 min | ‚ùå Exceso | Manual: 1-5 productos |
| Agregar 50 productos | ‚ùå 50 min | ‚úÖ 2 min | CSV: >10 productos |
| Editar 1 precio | ‚úÖ 30 seg | ‚ùå Exceso | Manual: cambio puntual |
| Actualizar 20 precios | ‚ùå 20 min | ‚úÖ 5 min | CSV: cambios masivos |
| Cambiar horarios | ‚úÖ 1 min | ‚úÖ 1 min | Ambos igual |

---

**Versi√≥n:** 1.0  
**√öltima actualizaci√≥n:** 2025-01-02  
**Descarga plantillas:** Panel ‚Üí Importar ‚Üí "Descargar plantillas"
